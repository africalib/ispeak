import{d as L,g as A,c,o as n,p as q,v as K,q as v,b as s,m as C,_ as I,s as G,x as B,y as w,z as $,j as H,A as J,B as O,C as V,t as S,n as x,r as Q,w as W,e as X,f as M,D as j,F as Y,u as Z}from"./index-CWAGXS1P.js";const ee={class:"speak-content"},te=L({__name:"SpeakContent",setup(l){const _=C(),d=A(_);return(r,e)=>(n(),c("div",ee,[q(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=g=>v(d).content=g),class:"form-control",placeholder:"ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”",rows:"20"},null,512),[[K,v(d).content,void 0,{trim:!0}]])]))}}),se=I(te,[["__scopeId","data-v-b9d48feb"]]);let i=null;const ne=G("recognition",{state:()=>({isListening:!1}),actions:{async initializeRecognition(){if(i)return i;if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window))return console.warn("Speech Recognition API not supported."),null;const l=window.SpeechRecognition||window.webkitSpeechRecognition;return i=new l,i.lang="ko-KR",i.interimResults=!1,i.continuous=!0,i.onend=()=>{this.isListening=!1,console.log("Recognition instance stopped.")},i},startListening(){if(!(!i||this.isListening))try{i.start(),this.isListening=!0,console.log("Recognition started.")}catch(l){console.error("Recognition start error:",l)}},stopListening(){if(!(!i||!this.isListening))try{i.stop(),this.isListening=!1,console.log("Recognition stopped.")}catch(l){console.warn("Recognition stop error:",l)}},getRecognitionInstance(){return i}}}),oe={class:"speak-core"},ie={class:"wrapper"},ae={key:0,class:"message"},ce=["textContent"],re=["innerHTML"],le=["innerHTML"],ue={key:1,class:"verse"},de={class:"bottom"},pe={key:2,class:"btn btn-dark no-act"},fe={key:0},_e={key:1},ge={class:"dots"},me=2e3,ke=2e3,he=L({__name:"SpeakCore",setup(l){const _=C(),d=A(_),r=ne(),e=B({idx:0,start:!1,finish:!1,dots:""}),g=w("startAudioRef"),m=w("successAudioRef"),p=w("failAudioRef"),y=w("finishAudioRef"),o=B({emoji:"ğŸš€",value:"<b>ì¤€ë¹„</b>ë˜ì…¨ë‚˜ìš”?",desc:"ì¡°ìš©í•œ ê³³ì—ì„œ ì‹œì‘í•˜ë©´ ë” ì¢‹ì•„ìš”."}),k=$(()=>d.content.replace(/\(.*?\)/g,"").trim().split(`
`).map(t=>t.trim()).filter(t=>t.length>0)),a=$(()=>k.value[e.idx]?.replace(/^\d+/,"")?.replace(/\./g,"")||"");let u=null;const E=()=>{let t=0;clearInterval(u),u=window.setInterval(()=>{t=t%5+1,e.dots=".".repeat(t)},350)},R=t=>{switch(t){case"start":g.value?.play();break;case"success":m.value?.play();break;case"fail":p.value?.play();break;case"finish":y.value?.play();break}},F=t=>{e.idx<k.value.length&&(r.stopListening(),b("ğŸ‘","<b>í†µê³¼</b>í–ˆì–´ìš”!",t),R("success"),setTimeout(()=>{if(e.idx===k.value.length-1){b("ğŸ‰","<b>ì•„ì´ìŠ¤í”½</b>ì„ ì™„ë£Œí–ˆì–´ìš”!","ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”."),R("finish"),e.finish=!0,r.stopListening();return}o.value="",e.idx++,r.startListening()},me))},P=()=>{u&&(clearInterval(u),u=null,e.dots="")},b=(t,f,h="")=>{o.emoji=t,o.value=f,o.desc=h},N=()=>{R("start"),o.value="",e.start=!0,r.startListening(),E()};return H(async()=>{const t=await r.initializeRecognition();t&&(t.onresult=f=>{const h=f.results[f.results.length-1];if(!h.isFinal)return;const T=h[0].transcript.trim(),U=a.value,D=J(T,U),z=(D*100).toFixed(2)+"% ì¼ì¹˜";console.log("ì‚¬ìš©ì ìŒì„±:",T),D>=.6?F(z):(b("ğŸ¤”","<b>í•œ ë²ˆ ë”</b> í•´ì£¼ì„¸ìš”.",z),R("fail"),O(()=>{}),setTimeout(()=>{o.value=""},ke))})}),V(()=>{P()}),(t,f)=>{const h=Q("router-link");return n(),c("div",oe,[s("div",ie,[o.value?(n(),c("div",ae,[s("div",{class:"emoji",textContent:S(o.emoji)},null,8,ce),s("div",{class:"value",innerHTML:o.value},null,8,re),s("div",{class:"desc",innerHTML:o.desc},null,8,le)])):(n(),c("div",ue,S(a.value),1)),s("div",de,[e.start?e.finish?(n(),x(h,{key:1,to:"../",class:"btn btn-dark"},{default:W(()=>[...f[0]||(f[0]=[s("span",null,"í™ˆìœ¼ë¡œ ì´ë™",-1)])]),_:1})):(n(),c("button",pe,[v(r).isListening?(n(),c("span",fe,"ë“£ëŠ” ì¤‘")):(n(),c("span",_e,"ëŒ€ê¸° ì¤‘")),s("span",ge,S(e.dots),1)])):(n(),c("button",{key:0,class:"btn btn-dark",onClick:N},"ì‹œì‘í•˜ê¸°"))])]),s("audio",{src:"../assets/sounds/game-start-317318.mp3",preload:"auto",ref_key:"startAudioRef",ref:g},null,512),s("audio",{src:"../assets/sounds/successed-295058.mp3",preload:"auto",ref_key:"successAudioRef",ref:m},null,512),s("audio",{src:"../assets/sounds/error-08-206492.mp3",preload:"auto",ref_key:"failAudioRef",ref:p},null,512),s("audio",{src:"../assets/sounds/yay-6120.mp3",preload:"auto",ref_key:"finishAudioRef",ref:y},null,512)])}}}),ve=I(he,[["__scopeId","data-v-d676ebcf"]]),ye={class:"container"},Re={class:"content"},we={key:1,class:"empty"},be=L({__name:"SpeakDetail",setup(l){const _=C(),d=Z(),{getById:r}=X(),e=A(_),g=window.Number.parseInt(_.params.id),m=M(!0),p=M(null),y=async()=>{try{m.value=!0;const a=await r(g);a?e.setData(a.id,a.title,a.content):d.push("/")}catch(a){console.error("Error loading speak:",a),d.push("/")}finally{m.value=!1}},o=()=>{if(p.value){const a=p.value.getBoundingClientRect(),u=window.innerHeight-a.top-15;p.value.style.height=`${u}px`}},k=()=>{o()};return H(async()=>{await y(),o(),window.addEventListener("resize",k)}),V(()=>{window.removeEventListener("resize",k)}),(a,u)=>(n(),c("div",{class:"speak-detail",ref_key:"rootRef",ref:p},[s("div",ye,[s("div",Re,[v(e).id?(n(),c(Y,{key:0},[v(e).mode==="edit"?(n(),x(se,{key:0})):v(e).mode==="speak"?(n(),x(ve,{key:1})):j("",!0)],64)):m.value?j("",!0):(n(),c("div",we,"ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."))])])],512))}}),xe=I(be,[["__scopeId","data-v-300cf077"]]);export{xe as default};
