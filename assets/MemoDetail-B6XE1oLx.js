import{d as k,f as b,m as E,v as I,n as m,o as i,j as v,l as R,e as p,p as x,q as z,i as D,s as T,a as _,t as M,u as V,_ as C,b as F,x as L,y as $,F as N,c as B}from"./index-xp0ZujrC.js";const U=k({__name:"MemoContent",setup(S){const c=R(),r=b(c);return(f,a)=>E((i(),v("textarea",{"onUpdate:modelValue":a[0]||(a[0]=t=>m(r).content=t),class:"form-control",placeholder:"내용을 입력하세요",rows:"20"},null,512)),[[I,m(r).content,void 0,{trim:!0}]])}}),j={class:"memo-speak"},q={class:"verse"},A={class:"actions"},H=["disabled"],K=k({__name:"MemoSpeak",setup(S){const c=R(),r=V(),f=b(c),a=p(0),t=x(()=>f.content.split(`
`).map(s=>s.trim()).filter(s=>s.length>0)),h=x(()=>{const s=t.value[a.value];return s?z(s.replace(/^\d+/,""),".","").trim():""}),e=p(null),n=p(!1),l=()=>{if(e.value)try{e.value.start(),n.value=!0}catch{setTimeout(()=>l(),100)}},g=()=>{e.value&&!n.value&&l()},y=()=>{a.value<t.value.length-1?a.value++:(window.alert("모든 구절을 말했습니다."),n.value=!1,e.value=null,r.push("../"))};return D(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const s=window.SpeechRecognition||window.webkitSpeechRecognition;e.value=new s,e.value.lang="ko-KR",e.value.interimResults=!1,e.value.continuous=!1,e.value.onresult=u=>{const d=u.results[u.results.length-1];if(!d.isFinal)return;const o=d[0].transcript.trim(),w=h.value;console.log("사용자 음성:",o),T(o,w)>=.5?y():(alert("문장이 충분히 일치하지 않습니다. 다시 시도해주세요."),n.value=!1,setTimeout(()=>l(),300))},e.value.onend=()=>{e.value?setTimeout(()=>l(),300):n.value=!1},g()}}),(s,u)=>(i(),v("div",j,[_("div",q,M(h.value),1),_("div",A,[_("button",{class:"btn btn-primary",onClick:g,disabled:n.value},M(n.value?"듣는 중...":"시작하기"),9,H)])]))}}),G=C(K,[["__scopeId","data-v-1cfeca29"]]),J={class:"container"},O={class:"content"},P={key:1,class:"empty"},Q=k({__name:"MemoDetail",setup(S){const c=R(),r=V(),{getById:f,update:a}=F(),t=b(c),h=window.Number.parseInt(c.params.id),e=p(!0),n=p(null),l=async()=>{try{e.value=!0;const o=await f(h);o?t.setData(o.id,o.title,o.content):r.push("/")}catch(o){console.error("Error loading memo:",o),r.push("/")}finally{e.value=!1}},g=async()=>{if(t.id)try{await a(t.id,t.title,t.content)}catch(o){console.error("Error saving memo:",o)}},y=()=>t.$subscribe(()=>{g()});let s=null;const u=()=>{if(n.value){const o=n.value.getBoundingClientRect(),w=window.innerHeight-o.top-15;n.value.style.height=`${w}px`}},d=()=>{u()};return D(async()=>{await l(),s=y(),u(),window.addEventListener("resize",d)}),L(()=>{window.removeEventListener("resize",d),s?.()}),(o,w)=>(i(),v("div",{class:"memo-detail",ref_key:"rootRef",ref:n},[_("div",J,[_("div",O,[m(t).id?(i(),v(N,{key:0},[m(t).mode==="edit"?(i(),B(U,{key:0})):m(t).mode==="speak"?(i(),B(G,{key:1})):$("",!0)],64)):e.value?$("",!0):(i(),v("div",P,"데이터가 없습니다."))])])],512))}}),X=C(Q,[["__scopeId","data-v-ffc22af1"]]);export{X as default};
