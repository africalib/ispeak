import{d as A,j as T,c as r,o as n,s as G,v as J,f as h,b as o,p as C,_ as I,x as b,y as j,z,m as V,A as O,B as E,t as R,q as x,r as Q,w as W,h as X,i as H,C as P,F as Y,u as Z}from"./index-DUGSdRr8.js";const ee={class:"speak-content"},te=A({__name:"SpeakContent",setup(D){const d=C(),l=T(d);return(m,c)=>(n(),r("div",ee,[G(o("textarea",{"onUpdate:modelValue":c[0]||(c[0]=p=>h(l).content=p),class:"form-control",placeholder:"ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”",rows:"20"},null,512),[[J,h(l).content,void 0,{trim:!0}]])]))}}),se=I(te,[["__scopeId","data-v-b9d48feb"]]),oe={class:"speak-core"},ne={class:"wrapper"},ie={key:0,class:"message"},ae=["textContent"],re=["innerHTML"],ce=["innerHTML"],le={key:1,class:"verse"},ue={class:"bottom"},de={key:2,class:"btn btn-dark no-act"},pe={key:0},fe={key:1},_e={class:"dots"},me=1e3,ge=2e3,S=2e3,ke=A({__name:"SpeakCore",setup(D){new Audio("../assets/sounds/game-start-317318.mp3"),new Audio("../assets/sounds/successed-295058.mp3"),new Audio("../assets/sounds/error-08-206492.mp3"),new Audio("../assets/sounds/yay-6120.mp3");const d=C(),l=T(d),m=b("startAudioRef"),c=b("successAudioRef"),p=b("failAudioRef"),f=b("finishAudioRef"),e=j({idx:0,recognition:null,listening:!1,start:!1,finish:!1,dots:""}),i=j({emoji:"ğŸš€",value:"ì´ì œ <b>ì‹œì‘</b>í•©ë‹ˆë‹¤.",desc:"ì¡°ìš©í•œ ê³³ì—ì„œ ì‹œì‘í•˜ë©´ ë” ì¢‹ì•„ìš”."}),_=z(()=>l.content.replace(/\(.*?\)/g,"").trim().split(`
`).map(t=>t.trim()).filter(t=>t.length>0)),g=z(()=>_.value[e.idx]?.replace(/^\d+/,"")?.replace(/\./g,"")||"");let s=null;const y=()=>{let t=0;clearInterval(s),s=window.setInterval(()=>{t=t%5+1,e.dots=".".repeat(t)},350)},w=t=>{switch(t){case"start":m.value?.play();break;case"success":c.value?.play();break;case"fail":p.value?.play();break;case"finish":f.value?.play();break}},k=()=>{if(e.recognition)try{e.recognition.start(),e.listening=!0}catch{setTimeout(()=>k(),S)}},B=()=>{if(e.recognition){try{e.recognition.stop()}catch(t){console.warn("recognition stop error:",t)}e.recognition=null}e.listening=!1},F=t=>{e.idx<_.value.length&&(e.listening=!1,B(),setTimeout(()=>{v("ğŸ˜€","<b>í†µê³¼</b>í–ˆì–´ìš”!",t),w("success"),setTimeout(()=>{if(e.idx===_.value.length-1){v("ğŸ‰","<b>ì•„ì´ìŠ¤í”½</b>ì„ ì™„ë£Œí–ˆì–´ìš”!","ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”."),w("finish"),e.finish=!0,e.listening=!1,e.recognition=null;return}i.value="",e.idx++,k()},ge)},1e3))},N=()=>{s&&(clearInterval(s),s=null,e.dots="")},v=(t="",a="",u="")=>{i.emoji=t,i.value=a,i.desc=u},U=()=>{w("start"),v("â³","<b>ì¤€ë¹„ ì¤‘</b>ì…ë‹ˆë‹¤.","ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."),setTimeout(()=>{v(),e.start=!0,k(),y()},me)},q=(t=>{const a=t*100;return(a%1===0?a.toString():a.toFixed(2))+"% ì¼ì¹˜"});return V(async()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;e.recognition=new t,e.recognition.lang="ko-KR",e.recognition.interimResults=!1,e.recognition.continuous=!1,e.recognition.onresult=a=>{const u=a.results[a.results.length-1];if(!u.isFinal)return;const $=u[0].transcript.trim(),K=g.value,L=O($,K),M=q(L);console.log("ì‚¬ìš©ì ìŒì„±:",$),L>=.6?F(M):(e.listening=!1,v("ğŸ¤”","<b>í•œ ë²ˆ ë”</b> í•´ì£¼ì„¸ìš”.",M),w("fail"),setTimeout(()=>{k(),i.value=""},S))},e.recognition.onend=()=>{e.recognition?setTimeout(()=>k(),S):e.listening=!1}}}),E(()=>{N(),B()}),(t,a)=>{const u=Q("router-link");return n(),r("div",oe,[o("div",ne,[i.value?(n(),r("div",ie,[o("div",{class:"emoji",textContent:R(i.emoji)},null,8,ae),o("div",{class:"value",innerHTML:i.value},null,8,re),o("div",{class:"desc",innerHTML:i.desc},null,8,ce)])):(n(),r("div",le,R(g.value),1)),o("div",ue,[e.start?e.finish?(n(),x(u,{key:1,to:"../",class:"btn btn-dark"},{default:W(()=>[...a[0]||(a[0]=[o("span",null,"í™ˆìœ¼ë¡œ ì´ë™",-1)])]),_:1})):(n(),r("button",de,[e.listening?(n(),r("span",pe,"ë“£ëŠ” ì¤‘")):(n(),r("span",fe,"ëŒ€ê¸° ì¤‘")),o("span",_e,R(e.dots),1)])):(n(),r("button",{key:0,class:"btn btn-dark",onClick:U},"ì‹œì‘í•˜ê¸°"))])]),o("audio",{src:"../assets/sounds/game-start-317318.mp3",preload:"auto",ref_key:"startAudioRef",ref:m},null,512),o("audio",{src:"../assets/sounds/successed-295058.mp3",preload:"auto",ref_key:"successAudioRef",ref:c},null,512),o("audio",{src:"../assets/sounds/error-08-206492.mp3",preload:"auto",ref_key:"failAudioRef",ref:p},null,512),o("audio",{src:"../assets/sounds/yay-6120.mp3",preload:"auto",ref_key:"finishAudioRef",ref:f},null,512)])}}}),ve=I(ke,[["__scopeId","data-v-46ffcb7d"]]),he={class:"container"},ye={class:"content"},we={key:1,class:"empty"},be=A({__name:"SpeakDetail",setup(D){const d=C(),l=Z(),{getById:m}=X(),c=T(d),p=window.Number.parseInt(d.params.id),f=H(!0),e=H(null),i=async()=>{try{f.value=!0;const s=await m(p);s?c.setData(s.id,s.title,s.content):l.push("/")}catch(s){console.error("Error loading speak:",s),l.push("/")}finally{f.value=!1}},_=()=>{if(e.value){const s=e.value.getBoundingClientRect(),y=window.innerHeight-s.top-15;e.value.style.height=`${y}px`}},g=()=>{_()};return V(async()=>{await i(),_(),window.addEventListener("resize",g)}),E(()=>{window.removeEventListener("resize",g)}),(s,y)=>(n(),r("div",{class:"speak-detail",ref_key:"rootRef",ref:e},[o("div",he,[o("div",ye,[h(c).id?(n(),r(Y,{key:0},[h(c).mode==="edit"?(n(),x(se,{key:0})):h(c).mode==="speak"?(n(),x(ve,{key:1})):P("",!0)],64)):f.value?P("",!0):(n(),r("div",we,"ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."))])])],512))}}),Se=I(be,[["__scopeId","data-v-300cf077"]]);export{Se as default};
