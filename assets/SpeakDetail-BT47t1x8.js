import{d as R,j as x,c,o as n,s as q,v as K,f as g,b as a,p as C,_ as T,x as G,y as $,z as M,m as A,A as J,B as H,t as w,q as S,r as O,w as Q,h as W,i as j,C as z,F as X,u as Y}from"./index-DwsOsldy.js";const Z={class:"speak-content"},ee=R({__name:"SpeakContent",setup(I){const m=C(),d=x(m);return(v,r)=>(n(),c("div",Z,[q(a("textarea",{"onUpdate:modelValue":r[0]||(r[0]=e=>g(d).content=e),class:"form-control",placeholder:"ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”",rows:"20"},null,512),[[K,g(d).content,void 0,{trim:!0}]])]))}}),te=T(ee,[["__scopeId","data-v-b9d48feb"]]),se={class:"speak-core"},ne={class:"wrapper"},oe={key:0,class:"message"},ie=["textContent"],ae=["innerHTML"],ce=["innerHTML"],re={key:1,class:"verse"},le={class:"bottom"},ue={key:2,class:"btn btn-dark no-act"},de={key:0},pe={key:1},_e={class:"dots"},me=1e3,fe=2e3,b=2e3,ge=R({__name:"SpeakCore",setup(I){const m={start:new Audio("../assets/sounds/game-start-317318.mp3"),success:new Audio("../assets/sounds/successed-295058.mp3"),fail:new Audio("../assets/sounds/error-08-206492.mp3"),finish:new Audio("../assets/sounds/yay-6120.mp3")},d=C(),v=x(d),r=G("audioRef"),e=$({idx:0,recognition:null,listening:!1,start:!1,finish:!1,dots:""}),o=$({emoji:"ğŸš€",value:"ì´ì œ <b>ì‹œì‘</b>í•©ë‹ˆë‹¤.",desc:"ì¡°ìš©í•œ ê³³ì—ì„œ ì‹œì‘í•˜ë©´ ë” ì¢‹ì•„ìš”."}),l=M(()=>v.content.replace(/\(.*?\)/g,"").trim().split(`
`).map(t=>t.trim()).filter(t=>t.length>0)),k=M(()=>l.value[e.idx]?.replace(/^\d+/,"")?.replace(/\./g,"")||"");let u=null;const h=()=>{let t=0;clearInterval(u),u=window.setInterval(()=>{t=t%5+1,e.dots=".".repeat(t)},350)},s=t=>{t==="start"?r.value?.play():m[t]?.play()},p=()=>{if(e.recognition)try{e.recognition.start(),e.listening=!0}catch{setTimeout(()=>p(),b)}},y=()=>{e.recognition&&!e.listening&&p()},P=()=>{if(e.recognition){try{e.recognition.stop()}catch(t){console.warn("recognition stop error:",t)}e.recognition=null}e.listening=!1},V=t=>{if(e.idx<l.value.length){if(e.listening=!1,e.recognition)try{e.recognition.stop()}catch{}f("ğŸ˜€","<b>í†µê³¼</b>í–ˆì–´ìš”!",t),s("success"),setTimeout(()=>{if(e.idx===l.value.length-1){f("ğŸ‰","<b>ì•„ì´ìŠ¤í”½</b>ì„ ì™„ë£Œí–ˆì–´ìš”!","ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”."),s("finish"),e.finish=!0,e.listening=!1,e.recognition=null;return}o.value="",e.idx++,y()},fe)}},E=()=>{u&&(clearInterval(u),u=null,e.dots="")},f=(t="",i="",_="")=>{o.emoji=t,o.value=i,o.desc=_},F=()=>{s("start"),f("â³","<b>ì¤€ë¹„ ì¤‘</b>ì…ë‹ˆë‹¤.","ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."),setTimeout(()=>{f(),e.start=!0,y(),h()},me)},N=(t=>{const i=t*100;return(i%1===0?i.toString():i.toFixed(2))+"% ì¼ì¹˜"});return A(async()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;e.recognition=new t,e.recognition.lang="ko-KR",e.recognition.interimResults=!1,e.recognition.continuous=!1,e.recognition.onresult=i=>{const _=i.results[i.results.length-1];if(!_.isFinal)return;const D=_[0].transcript.trim(),U=k.value,B=J(D,U),L=N(B);console.log("ì‚¬ìš©ì ìŒì„±:",D),B>=.6?V(L):(e.listening=!1,f("ğŸ¤”","<b>í•œ ë²ˆ ë”</b> í•´ì£¼ì„¸ìš”.",L),s("fail"),setTimeout(()=>{p(),o.value=""},b))},e.recognition.onend=()=>{e.recognition?setTimeout(()=>p(),b):e.listening=!1}}}),H(()=>{E(),P()}),(t,i)=>{const _=O("router-link");return n(),c("div",se,[a("div",ne,[o.value?(n(),c("div",oe,[a("div",{class:"emoji",textContent:w(o.emoji)},null,8,ie),a("div",{class:"value",innerHTML:o.value},null,8,ae),a("div",{class:"desc",innerHTML:o.desc},null,8,ce)])):(n(),c("div",re,w(k.value),1)),a("div",le,[e.start?e.finish?(n(),S(_,{key:1,to:"../",class:"btn btn-dark",onClick:y},{default:Q(()=>[...i[0]||(i[0]=[a("span",null,"í™ˆìœ¼ë¡œ ì´ë™",-1)])]),_:1})):(n(),c("button",ue,[e.listening?(n(),c("span",de,"ë“£ëŠ” ì¤‘")):(n(),c("span",pe,"ëŒ€ê¸° ì¤‘")),a("span",_e,w(e.dots),1)])):(n(),c("button",{key:0,class:"btn btn-dark",onClick:F},"ì‹œì‘í•˜ê¸°"))])]),a("audio",{src:"../assets/sounds/game-start-317318.mp3",ref_key:"audioRef",ref:r},null,512)])}}}),ve=T(ge,[["__scopeId","data-v-9db55c99"]]),ke={class:"container"},he={class:"content"},ye={key:1,class:"empty"},we=R({__name:"SpeakDetail",setup(I){const m=C(),d=Y(),{getById:v}=W(),r=x(m),e=window.Number.parseInt(m.params.id),o=j(!0),l=j(null),k=async()=>{try{o.value=!0;const s=await v(e);s?r.setData(s.id,s.title,s.content):d.push("/")}catch(s){console.error("Error loading speak:",s),d.push("/")}finally{o.value=!1}},u=()=>{if(l.value){const s=l.value.getBoundingClientRect(),p=window.innerHeight-s.top-15;l.value.style.height=`${p}px`}},h=()=>{u()};return A(async()=>{await k(),u(),window.addEventListener("resize",h)}),H(()=>{window.removeEventListener("resize",h)}),(s,p)=>(n(),c("div",{class:"speak-detail",ref_key:"rootRef",ref:l},[a("div",ke,[a("div",he,[g(r).id?(n(),c(X,{key:0},[g(r).mode==="edit"?(n(),S(te,{key:0})):g(r).mode==="speak"?(n(),S(ve,{key:1})):z("",!0)],64)):o.value?z("",!0):(n(),c("div",ye,"ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."))])])],512))}}),Se=T(we,[["__scopeId","data-v-300cf077"]]);export{Se as default};
