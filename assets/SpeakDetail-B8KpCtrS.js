import{d as I,g as T,c,o as n,n as U,v as q,p as k,b as r,l as B,_ as D,f as d,q as z,s as K,x as G,j as V,y as J,z as O,A as E,t as R,m as C,r as Q,w as W,e as X,B as L,F as Y,u as Z}from"./index-DNIIyHMa.js";const ee={class:"speak-content"},te=I({__name:"SpeakContent",setup($){const p=B(),v=T(p);return(_,i)=>(n(),c("div",ee,[U(r("textarea",{"onUpdate:modelValue":i[0]||(i[0]=m=>k(v).content=m),class:"form-control",placeholder:"내용을 입력하세요",rows:"20"},null,512),[[q,k(v).content,void 0,{trim:!0}]])]))}}),se=D(te,[["__scopeId","data-v-b9d48feb"]]),ae={class:"speak-core"},ne={class:"wrapper"},oe={key:0,class:"message"},le=["textContent"],ce=["innerHTML"],ie={key:1,class:"verse"},re={class:"bottom"},ue={key:2,class:"btn btn-dark no-act"},de={key:0},ve={key:1},pe={class:"dots"},_e=2e3,x=2e3,me=I({__name:"SpeakCore",setup($){const p=B(),v=T(p),_=d(0),i=z(()=>v.content.replace(/\(.*?\)/g,"").trim().split(`
`).map(t=>t.trim()).filter(t=>t.length>0)),m=z(()=>i.value[_.value]?.replace(/^\d+/,"")?.replace(/\./g,"")||""),e=d(null),s=d(!1),h=d(!1),f=d(!1),l=K({emoji:"🚀",value:"<b>시작하기</b> 버튼을 클릭하세요."}),a=d("");let o=null;const M=()=>{let t=0;o=window.setInterval(()=>{if(f.value||!s.value){clearInterval(o),o=null,a.value="";return}t=t%5+1,a.value=".".repeat(t)},500)},F={start:"../assets/sounds/game-start-317318.mp3",success:"../assets/sounds/successed-295058.mp3",fail:"../assets/sounds/error-08-206492.mp3",finish:"../assets/sounds/yay-6120.mp3"},g=t=>{new Audio(F[t]).play()},y=()=>{if(e.value)try{e.value.start(),s.value=!0}catch{setTimeout(()=>y(),x)}},b=()=>{e.value&&!s.value&&y()},H=()=>{if(e.value){try{e.value.stop()}catch(t){console.warn("recognition stop error:",t)}e.value=null}s.value=!1},N=()=>{if(_.value<i.value.length-1){if(s.value=!1,e.value)try{e.value.stop()}catch{}S("👍","<b>통과</b>했어요!"),g("success"),setTimeout(()=>{l.value="",_.value++,b()},_e)}else S("🎉","<b>아이스픽</b>을 완료했어요!"),g("finish"),f.value=!0,s.value=!1,e.value=null};G(s,t=>{t?M():o&&(clearInterval(o),o=null,a.value="")});const S=(t,u)=>{l.emoji=t,l.value=u},A=()=>{l.value="",g("start"),h.value=!0,b()};return V(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;e.value=new t,e.value.lang="ko-KR",e.value.interimResults=!1,e.value.continuous=!1,e.value.onresult=u=>{const w=u.results[u.results.length-1];if(!w.isFinal)return;const j=w[0].transcript.trim(),P=m.value;console.log("사용자 음성:",j),J(j,P)>=.6?N():(s.value=!1,S("🤔","음.. <b>한 번 더</b> 해주세요."),g("fail"),O(()=>{y()}),setTimeout(()=>{l.value=""},x))},e.value.onend=()=>{e.value?setTimeout(()=>y(),x):s.value=!1}}}),E(()=>{o&&(clearInterval(o),o=null),H()}),(t,u)=>{const w=Q("router-link");return n(),c("div",ae,[r("div",ne,[l.value?(n(),c("div",oe,[r("div",{class:"emoji",textContent:R(l.emoji)},null,8,le),r("div",{class:"value",innerHTML:l.value},null,8,ce)])):(n(),c("div",ie,R(m.value),1)),r("div",re,[h.value?f.value?(n(),C(w,{key:1,to:"../",class:"btn btn-dark",onClick:b},{default:W(()=>[...u[0]||(u[0]=[r("span",null,"홈으로 이동",-1)])]),_:1})):(n(),c("button",ue,[s.value?(n(),c("span",de,"듣는 중")):(n(),c("span",ve,"대기 중")),r("span",pe,R(a.value),1)])):(n(),c("button",{key:0,class:"btn btn-dark",onClick:A},"시작하기"))])])])}}}),fe=D(me,[["__scopeId","data-v-48ee922b"]]),ke={class:"container"},he={class:"content"},ge={key:1,class:"empty"},ye=I({__name:"SpeakDetail",setup($){const p=B(),v=Z(),{getById:_}=X(),i=T(p),m=window.Number.parseInt(p.params.id),e=d(!0),s=d(null),h=async()=>{try{e.value=!0;const a=await _(m);a?i.setData(a.id,a.title,a.content):v.push("/")}catch(a){console.error("Error loading speak:",a),v.push("/")}finally{e.value=!1}},f=()=>{if(s.value){const a=s.value.getBoundingClientRect(),o=window.innerHeight-a.top-15;s.value.style.height=`${o}px`}},l=()=>{f()};return V(async()=>{await h(),f(),window.addEventListener("resize",l)}),E(()=>{window.removeEventListener("resize",l)}),(a,o)=>(n(),c("div",{class:"speak-detail",ref_key:"rootRef",ref:s},[r("div",ke,[r("div",he,[k(i).id?(n(),c(Y,{key:0},[k(i).mode==="edit"?(n(),C(se,{key:0})):k(i).mode==="speak"?(n(),C(fe,{key:1})):L("",!0)],64)):e.value?L("",!0):(n(),c("div",ge,"데이터가 없습니다."))])])],512))}}),be=D(ye,[["__scopeId","data-v-300cf077"]]);export{be as default};
