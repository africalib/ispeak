import{d as S,g as x,c as u,o as l,n as F,a as L,v as j,p as w,b as r,w as V,r as B,l as M,_ as I,f as v,q as $,s as U,j as z,x as q,y as E,t as D,m as y,z as R,A,e as H,F as K,u as G}from"./index-DXjWOH22.js";const J="/ispeak/assets/images/component.header.microphone.svg",O={class:"memo-content"},P=S({__name:"MemoContent",setup(C){const p=M(),d=x(p);return(_,i)=>{const o=B("router-link");return l(),u("div",O,[F(r("textarea",{"onUpdate:modelValue":i[0]||(i[0]=t=>w(d).content=t),class:"form-control",placeholder:"내용을 입력하세요",rows:"20"},null,512),[[j,w(d).content,void 0,{trim:!0}]]),L(o,{to:"?mode=speak",role:"button",class:"act"},{default:V(()=>[...i[1]||(i[1]=[r("img",{src:J,alt:"스픽 아이콘"},null,-1)])]),_:1})])}}}),Q=I(P,[["__scopeId","data-v-babff623"]]),W={class:"memo-speak"},X={key:0,class:"emoji"},Y={key:1,class:"verse"},Z={class:"actions"},ee=["disabled"],te={class:"dots"},se=S({__name:"MemoSpeak",setup(C){const p=M(),d=x(p),_=v(0),i=$(()=>d.content.replace(/\(.*?\)/g,"").trim().split(`
`).map(e=>e.trim()).filter(e=>e.length>0)),o=$(()=>i.value[_.value]?.replace(/^\d+/,"")?.replace(/\./g,"")||""),t=v(null),s=v(!1),c=v(!1),f=v("");let a=null;const b=()=>{let e=0;a=window.setInterval(()=>{if(c.value||!s.value){clearInterval(a),a=null,f.value="";return}e=e%5+1,f.value=".".repeat(e)},500)},m=()=>{if(t.value)try{t.value.start(),s.value=!0}catch{setTimeout(()=>m(),100)}},g=()=>{t.value&&!s.value&&m()},h=()=>{_.value<i.value.length-1?_.value++:(c.value=!0,s.value=!1,t.value=null)};return U(s,e=>{e?b():a&&(clearInterval(a),a=null,f.value="")}),z(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const e=window.SpeechRecognition||window.webkitSpeechRecognition;t.value=new e,t.value.lang="ko-KR",t.value.interimResults=!1,t.value.continuous=!1,t.value.onresult=n=>{const k=n.results[n.results.length-1];if(!k.isFinal)return;const N=k[0].transcript.trim(),T=o.value;q(N,T)>=.6?h():(alert("문장이 충분히 일치하지 않습니다. 다시 시도해주세요."),s.value=!1,setTimeout(()=>m(),300))},t.value.onend=()=>{t.value?setTimeout(()=>m(),300):s.value=!1},g()}}),E(()=>{if(a&&(clearInterval(a),a=null),t.value){try{t.value.stop()}catch(e){console.warn("recognition stop error:",e)}t.value=null}s.value=!1}),(e,n)=>{const k=B("router-link");return l(),u("div",W,[c.value?(l(),u("div",X,[...n[0]||(n[0]=[r("div",null,"✅",-1),r("span",null,"스픽을 ",-1),r("b",null,"완료했습니다.",-1)])])):(l(),u("div",Y,D(o.value),1)),r("div",Z,[c.value?(l(),y(k,{key:0,to:"../",class:"btn btn-default",onClick:g,disabled:s.value},{default:V(()=>[...n[1]||(n[1]=[A(" 🏠 홈으로 이동 ",-1)])]),_:1},8,["disabled"])):s.value?(l(),u("button",{key:1,class:"btn btn-default",onClick:g,disabled:s.value},[n[2]||(n[2]=r("span",null,"🎧 듣는 중",-1)),r("span",te,D(f.value),1)],8,ee)):R("",!0)])])}}}),oe=I(se,[["__scopeId","data-v-63961d8b"]]),ne={class:"container"},ae={class:"content"},le={key:1,class:"empty"},re=S({__name:"MemoDetail",setup(C){const p=M(),d=G(),{getById:_,update:i}=H(),o=x(p),t=window.Number.parseInt(p.params.id),s=v(!0),c=v(null),f=async()=>{try{s.value=!0;const e=await _(t);e?o.setData(e.id,e.title,e.content):d.push("/")}catch(e){console.error("Error loading memo:",e),d.push("/")}finally{s.value=!1}},a=async()=>{if(o.id)try{await i(o.id,o.title,o.content)}catch(e){console.error("Error saving memo:",e)}},b=()=>o.$subscribe(()=>{a()});let m=null;const g=()=>{if(c.value){const e=c.value.getBoundingClientRect(),n=window.innerHeight-e.top-15;c.value.style.height=`${n}px`}},h=()=>{g()};return z(async()=>{await f(),m=b(),g(),window.addEventListener("resize",h)}),E(()=>{window.removeEventListener("resize",h),m?.()}),(e,n)=>(l(),u("div",{class:"memo-detail",ref_key:"rootRef",ref:c},[r("div",ne,[r("div",ae,[w(o).id?(l(),u(K,{key:0},[w(o).mode==="edit"?(l(),y(Q,{key:0})):w(o).mode==="speak"?(l(),y(oe,{key:1})):R("",!0)],64)):s.value?R("",!0):(l(),u("div",le,"데이터가 없습니다."))])])],512))}}),ce=I(re,[["__scopeId","data-v-ffc22af1"]]);export{ce as default};
