import{d as k,f as b,m as E,v as I,n as m,o as i,j as p,l as R,e as v,p as x,i as D,q as z,a as _,t as M,u as V,_ as C,b as T,s as F,x as $,F as L,c as B}from"./index-dEifBmyA.js";const N=k({__name:"MemoContent",setup(S){const c=R(),r=b(c);return(f,a)=>E((i(),p("textarea",{"onUpdate:modelValue":a[0]||(a[0]=t=>m(r).content=t),class:"form-control",placeholder:"내용을 입력하세요",rows:"20"},null,512)),[[I,m(r).content,void 0,{trim:!0}]])}}),U={class:"memo-speak"},j={class:"verse"},q={class:"actions"},H=["disabled"],K=k({__name:"MemoSpeak",setup(S){const c=R(),r=V(),f=b(c),a=v(0),t=x(()=>f.content.replace(/\(.*?\)/g,"").trim().split(`
`).map(n=>n.trim()).filter(n=>n.length>0)),g=x(()=>t.value[a.value]?.replace(/^\d+/,"")?.replace(/\./g,"")||""),e=v(null),s=v(!1),l=()=>{if(e.value)try{e.value.start(),s.value=!0}catch{setTimeout(()=>l(),100)}},h=()=>{e.value&&!s.value&&l()},y=()=>{a.value<t.value.length-1?a.value++:(window.alert("모든 구절을 말했습니다."),s.value=!1,e.value=null,r.push("../"))};return D(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const n=window.SpeechRecognition||window.webkitSpeechRecognition;e.value=new n,e.value.lang="ko-KR",e.value.interimResults=!1,e.value.continuous=!1,e.value.onresult=u=>{const d=u.results[u.results.length-1];if(!d.isFinal)return;const o=d[0].transcript.trim(),w=g.value;console.log("사용자 음성:",o),z(o,w)>=.5?y():(alert("문장이 충분히 일치하지 않습니다. 다시 시도해주세요."),s.value=!1,setTimeout(()=>l(),300))},e.value.onend=()=>{e.value?setTimeout(()=>l(),300):s.value=!1},h()}}),(n,u)=>(i(),p("div",U,[_("div",j,M(g.value),1),_("div",q,[_("button",{class:"btn btn-primary",onClick:h,disabled:s.value},M(s.value?"듣는 중...":"시작하기"),9,H)])]))}}),A=C(K,[["__scopeId","data-v-5194b452"]]),G={class:"container"},J={class:"content"},O={key:1,class:"empty"},P=k({__name:"MemoDetail",setup(S){const c=R(),r=V(),{getById:f,update:a}=T(),t=b(c),g=window.Number.parseInt(c.params.id),e=v(!0),s=v(null),l=async()=>{try{e.value=!0;const o=await f(g);o?t.setData(o.id,o.title,o.content):r.push("/")}catch(o){console.error("Error loading memo:",o),r.push("/")}finally{e.value=!1}},h=async()=>{if(t.id)try{await a(t.id,t.title,t.content)}catch(o){console.error("Error saving memo:",o)}},y=()=>t.$subscribe(()=>{h()});let n=null;const u=()=>{if(s.value){const o=s.value.getBoundingClientRect(),w=window.innerHeight-o.top-15;s.value.style.height=`${w}px`}},d=()=>{u()};return D(async()=>{await l(),n=y(),u(),window.addEventListener("resize",d)}),F(()=>{window.removeEventListener("resize",d),n?.()}),(o,w)=>(i(),p("div",{class:"memo-detail",ref_key:"rootRef",ref:s},[_("div",G,[_("div",J,[m(t).id?(i(),p(L,{key:0},[m(t).mode==="edit"?(i(),B(N,{key:0})):m(t).mode==="speak"?(i(),B(A,{key:1})):$("",!0)],64)):e.value?$("",!0):(i(),p("div",O,"데이터가 없습니다."))])])],512))}}),W=C(P,[["__scopeId","data-v-ffc22af1"]]);export{W as default};
